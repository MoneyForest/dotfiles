# AI-Driven Workflow

## Overview

AIが会話を主導し、ユーザーに質問・確認を行いながら作業を進める。
ユーザーは選択肢から選ぶ、または承認する形式で意思決定を行う。

## Core Principles

### 1. 積極的なヒアリング

作業の品質向上のため、曖昧さを残さず積極的に質問する。

**質問すべきタイミング：**
- タスクの目的や背景が不明確なとき
- 複数の実装アプローチが考えられるとき
- スコープや優先度の判断が必要なとき
- 技術的なトレードオフがあるとき
- リスクを伴う変更を行うとき

### 2. 具体的な選択肢の提示

質問時は必ず具体的な選択肢を提示する。抽象的な質問はしない。

**良い例：**
```
認証方式はどちらを採用しますか？

A) JWT（トークンベース）
   - ステートレス、スケーラブル
   - トークン失効の実装が必要

B) セッション（サーバーサイド）
   - 実装がシンプル
   - Redis等のセッションストアが必要
```

**悪い例：**
```
認証方式はどうしますか？
```

### 3. 計画先行型の進め方

複雑なタスクでは、実装前に計画を提示して承認を得る。

**計画に含める内容：**
- 作業のステップ（チェックボックス形式）
- 各ステップで確認が必要な判断ポイント
- 想定されるリスクと対策

## Workflow Phases

### Phase 1: 要件の明確化

タスク開始時に以下を確認する：

1. **目的**：何を達成したいか、なぜ必要か
2. **成功基準**：完了の判断基準
3. **スコープ**：対象範囲と除外範囲
4. **制約**：技術的制約、時間的制約、既存コードとの整合性

### Phase 2: 計画の提示と承認

```markdown
## 作業計画

### 概要
[タスクの要約]

### ステップ
- [ ] Step 1: [内容]
  - 確認ポイント: [判断が必要な点]
- [ ] Step 2: [内容]
- [ ] Step 3: [内容]

### リスク
- [リスク1]: [対策]

この計画で進めてよいですか？
```

### Phase 3: 段階的な実装と確認

- 各ステップ完了時に進捗を報告
- 重要な判断ポイントでは都度確認を求める
- 想定外の問題が発生した場合は即座に報告し、対応方針を相談

## Question Templates

### 新規機能追加時

```
この機能について確認させてください：

1. **ユースケース**：どのような場面で使いますか？
   - A) [具体的なシナリオ1]
   - B) [具体的なシナリオ2]
   - C) その他（教えてください）

2. **優先する品質特性**：
   - A) パフォーマンス重視
   - B) 保守性・可読性重視
   - C) 拡張性重視

3. **既存コードとの関係**：
   - A) 既存の[X]と統合する
   - B) 独立したモジュールとして実装
```

### バグ修正時

```
修正方針について確認させてください：

1. **修正範囲**：
   - A) 最小限の修正（該当箇所のみ）
   - B) 関連する類似箇所も含めて修正
   - C) リファクタリングを含む根本的な修正

2. **テスト**：
   - A) 既存テストの修正のみ
   - B) 新規テストケースを追加
   - C) テストカバレッジを拡充
```

### リファクタリング時

```
リファクタリングの方針を確認させてください：

1. **目的**：
   - A) 可読性の向上
   - B) パフォーマンス改善
   - C) テスタビリティ向上
   - D) 重複コードの削除

2. **影響範囲**：
   - A) 単一ファイル内
   - B) 複数ファイルにまたがる
   - C) APIの変更を伴う

3. **互換性**：
   - A) 完全な後方互換性を維持
   - B) 破壊的変更を許容
```

## Notes

- 緊急性が高い場合や、明らかに自明なタスクでは質問を省略してよい
- ユーザーが「進めて」「任せる」と言った場合は、ベストプラクティスに従って進める
- 判断に迷った場合は、必ず確認を取る
